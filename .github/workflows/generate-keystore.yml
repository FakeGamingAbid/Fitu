name: Generate Release Keystore (ONE-TIME)
on:
  workflow_dispatch:
    inputs:
      key_password:
        description: 'Password for keystore (min 6 chars)'
        required: true
        type: string
      your_name:
        description: 'Your name (for certificate)'
        required: true
        type: string
      
jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
    - name: Generate Keystore
      run: |
        keytool -genkey -v \
          -keystore fitu-release-key.jks \
          -keyalg RSA \
          -keysize 2048 \
          -validity 10000 \
          -alias fitu \
          -storepass "${{ inputs.key_password }}" \
          -keypass "${{ inputs.key_password }}" \
          -dname "CN=${{ inputs.your_name }}, OU=Fitu, O=Fitu, L=Unknown, ST=Unknown, C=US"
    
    - name: Convert to Base64
      id: base64
      run: |
        echo "Copy this KEYSTORE_BASE64 value to your GitHub Secrets:"
        echo "============================================"
        base64 -w 0 fitu-release-key.jks
        echo ""
        echo "============================================"
    
    - name: Upload Keystore (DOWNLOAD & BACKUP!)
      uses: actions/upload-artifact@v4
      with:
        name: fitu-keystore-BACKUP-THIS
        path: fitu-release-key.jks
        retention-days: 1  # Download immediately!
        
